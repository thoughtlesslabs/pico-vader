pico-8 cartridge // http://www.pico-8.com
version 32
__lua__
function _init()
	make_player()
	s=1
	ss=1
end

function _update60()
	p.dy += 0.5

	if btn(0) then
		p.flipx = true
		p.dx = -2
	end
	if btn(1) then
		p.flipx = false
		p.dx = 2
	end
	
	if btnp(2) then
		if not p.jumping then
			p.dy = -5
			p.jumping = true
		end
	end
		
	if btnp(4) then
		s=1
		p.swinging = true
		timer = 5
	end
	
	if p.swinging then
		if timer < 0 then
			if ss <= #p.sprites[s] then
				ss +=1
				timer = 5
			end
		elseif ss == #p.sprites[s] then
				ss = 1
				p.swinging = false	
		end
		timer -=1.25
	end
	
	p.dx = p.dx / 1.2
	
	p.x += p.dx
	p.y += p.dy
	
	p.x = mid(0,p.x,112)
	p.y = mid(8,p.y,90)
	
	if p.y > 89 then
		p.jumping = false
	end
	
	if abs(p.dx) < 0.5 then
		p.dx = 0 
	end
end

function _draw()
	cls(15)
	pal()
	--drawbackground()

	draw_character()
end

function drawbackground()
	cls(15)
	palt(0,false)
	palt(13,true)
	fillp()
	rectfill(0,0,127,75,12)
	for i = 1,8 do
		digit =	flr(rnd(1))
	end
	fillp(0b1010010100100+digit+0)
	rectfill(0,64,127,67,12)
	rectfill(0,67,127,70,13)
	rectfill(0,70,127,75,2)
	rectfill(0,75,127,80,15)

	pal(7,5)
	pal(5,1)
	pal(15,133)
	sspr(56,0,16,16,10,66,15,15,true)
	sspr(56,0,16,16,50,66,10,10)
	sspr(56,0,16,16,30,66,15,15)
	sspr(56,0,16,16,80,66,15,15,true)
	sspr(56,0,16,16,100,66,10,10)
	sspr(56,0,16,16,0,66,15,15,true)
	sspr(56,0,16,16,90,66,15,15)
	pal()
	palt(0,false)
	palt(13,true)
	sspr(56,0,16,16,80,71,25,25)
	sspr(56,0,16,16,30,71,25,25)
end

function draw_character()
	palt(0,false)
	palt(7,true)
	spr(p.sprites[s][ss],p.x,p.y,2,2,p.flipx,p.flipy)
end

function make_player()
	p = {}
	p.x = 50
	p.y = 50
	p.dx =0
	p.dy =0
	p.flipx = false
	p.flipy = false
	p.jumping = false
	p.swinging = false
	p.sprites={{1,3,3,5,5,3,3},{33,33,35,35,33}}
end
-->8
-- to do list

--add light effects when saber
--hits an object
--
--walking movement in feet
--
--sound effects
--
--open and close lightsaber
--background with planets
__gfx__
00000000777777777777777777777777777777777777777777777777dddddddddddddddd00000000000000000000000000000000000000000000000000000000
00000000777777809777777777777780077777777777778807777777dddddddddddddddd00000000000000000000000000000000000000000000000000000000
00700700777778980777777777777899877777777777788987777777ddddd55ffffddddd00000000000000000000000000000000000000000000000000000000
00077000777778088777777777777880877777777777788087777777dddd55ffff7fdddd00000000000000000000000000000000000000000000000000000000
00077000777778808777778777777888077777777777788807777777ddd5fffffff7fddd00000000000000000000000000000000000000000000000000000000
00700700777777808777788777777780877777777777778807777777dd55ffffffffffdd00000000000000000000000000000000000000000000000000000000
00000000777700888777887777777788877777877777778887777787d5fffffffffffffd00000000000000000000000000000000000000000000000000000000
00000000777700000078877777778000007778287777700000777887d55ffffffffffffd00000000000000000000000000000000000000000000000000000000
00000000777700000588777777780000017788287777000001778877555555555555555500000000000000000000000000000000000000000000000000000000
0000000077700100550777777782010010118828777701001011877755ffffffffffffff00000000000000000000000000000000000000000000000000000000
000000007770010550077777772201000002822777770100000077775ffffffffff00ff700000000000000000000000000000000000000000000000000000000
0000000077770855100777777828200000828287777780000007777755ff7f0000f50ff700000000000000000000000000000000000000000000000000000000
000000007777880010777777782880001288228777788000107777775ffff75550f50f7f00000000000000000000000000000000000000000000000000000000
0000000077788010007777777888701088822877778870100077777755ffff5550fffff700000000000000000000000000000000000000000000000000000000
00000000778801100007777778877018288877777887701001077777f55fff5550fff55f00000000000000000000000000000000000000000000000000000000
000000007880000000077777777777777777777777777000010077775f5fff5550ff7ff500000000000000000000000000000000000000000000000000000000
00000000777777777777777777777780977777777777777777777777000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777777777777777777898077777777777777809777777000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777777777777777777808877777777777778980777777000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777780977777777777880877777877777778088777777000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777898077777777777780877778877778778808777777000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777808877777777770088877788777778877808777777000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777880877777877770000007887777777800888777777000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777780877778877770000058877777777700000077777000000000000000000000000000000000000000000000000000000000000000000000000
00000000777770088877788777700100550777777777770000177777000000000000000000000000000000000000000000000000000000000000000000000000
00000000777770000007887777700105500777777777771001007777000000000000000000000000000000000000000000000000000000000000000000000000
00000000777770000018877777770055100777777777771000007777000000000000000000000000000000000000000000000000000000000000000000000000
00000000777700100100777777770800107777777777700000000777000000000000000000000000000000000000000000000000000000000000000000000000
00000000777700100100777777778800007777777777700001000777000000000000000000000000000000000000000000000000000000000000000000000000
00000000777770000100777777788010007777777777700100078877000000000000000000000000000000000000000000000000000000000000000000000000
00000000777880110000777777880110000777777777000100007887000000000000000000000000000000000000000000000000000000000000000000000000
00000000778800000000777778800000000777777777000000007788000000000000000000000000000000000000000000000000000000000000000000000000
